{% extends 'base.html' %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8 offset-md-2 text-center">
        <h1>üîç Browse Jobs</h1>
        <p class="text-muted">Find your next project.</p>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6 offset-md-3">
        <form method="GET" class="d-flex gap-2">
            <select name="category" class="form-select">
                <option value="">All Categories</option>
                {% for cat in categories %}
                <option value="{{ cat.id }}" {% if request.GET.category == cat.id|stringformat:"s" %}selected{% endif %}>
                    {{ cat.name }}
                </option>
                {% endfor %}
            </select>
            <button type="submit" class="btn btn-primary">Filter</button>
        </form>
    </div>
</div>

<div class="row">
    <div class="col-md-8 offset-md-2">
        {% if jobs %}
            <div class="list-group">
                {% for job in jobs %}
                <div class="list-group-item list-group-item-action flex-column align-items-start p-4 mb-3 shadow-sm border rounded">
                    <div class="d-flex w-100 justify-content-between">
                        <h4 class="mb-1 text-primary">{{ job.title }}</h4>
                        <span class="badge bg-success fs-6">${{ job.budget }}</span>
                    </div>
                    
                    <p class="mb-1 text-muted">
                        Posted by <strong>{{ job.company_name|default:job.client_username }}</strong> 
                        &bull; {{ job.created_at|date:"M d, Y" }}
                    </p>
                    
                    <p class="mb-3">{{ job.description|truncatewords:30 }}</p>
                    
                    <a href="{% url 'job_detail' job.id %}" class="btn btn-outline-primary btn-sm">View Details & Apply</a>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="alert alert-info text-center">
                No jobs found. Try selecting a different category or come back later!
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}